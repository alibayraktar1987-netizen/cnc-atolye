name: CI

on:
  push:
    branches:
      - "**"
  pull_request:

jobs:
  validate-static:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Validate required files
        run: |
          test -f index.html
          test -f orders.html
          test -f openapi.yaml
          test -f README.md
          test -f docs/requirements.md

      - name: Check unresolved conflict markers
        run: |
          if grep -R --line-number -E "^(<<<<<<<|=======|>>>>>>>)" index.html orders.html js css docs openapi.yaml; then
            echo "Conflict marker found"
            exit 1
          fi

      - name: Validate OpenAPI syntax
        run: |
          python -m pip install --quiet openapi-spec-validator
          python -m openapi_spec_validator openapi.yaml
